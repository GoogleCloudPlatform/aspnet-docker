FROM gcr.io/cloud-builders/csharp/dotnet AS builder
COPY . /src
WORKDIR /src
RUN dotnet clean
RUN dotnet restore --packages /packages
RUN dotnet publish -c Release -o /published MainProject/MainProject.csproj

FROM aspnetcore:2.0
COPY --from=builder /published /app
WORKDIR /app
ENTRYPOINT [ "dotnet", "MainProject.dll" ]
